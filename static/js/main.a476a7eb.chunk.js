(this["webpackJsonpreal-time-transportation-service"]=this["webpackJsonpreal-time-transportation-service"]||[]).push([[0],{175:function(e,t,n){e.exports=n(400)},399:function(e,t,n){e.exports=n.p+"static/media/bus.1484f0a2.svg"},400:function(e,t,n){"use strict";n.r(t),n.d(t,"googleMapURL",(function(){return Oe}));var r=n(0),a=n.n(r),o=n(44),i=n(16),c=n.n(i),l=n(100),s=n(28),u=n(29),p=n(30),d=n(31),g=n(5),m=n(47),f=n(74),h=n(6);function b(){var e=Object(g.a)(["\n  cursor: pointer;\n  border-bottom: 1px solid #eee;\n  padding: 10px;\n  &:hover {\n    background-color: #eee;\n  }\n\n  p {\n    margin: 0;\n  }\n"]);return b=function(){return e},e}var v=h.a.div(b());function E(e){return a.a.createElement(v,{onClick:e.onClick},e.children)}var S={primaryColor:"#3F51B5",black:"#000",white:"#fff"},x=function(e){var t=e.iconName,n=e.fillColor,r=e.width,o=e.height;switch(t){case"bus":return a.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",version:"1.1",id:"Capa_1",x:"0px",y:"0px",viewBox:"0 0 405.333 405.333",width:r,height:o},a.a.createElement("g",null,a.a.createElement("g",null,a.a.createElement("g",null,a.a.createElement("path",{d:"M202.667,0C108.373,0,32,10.667,32,85.333v213.333c0,18.88,8.32,35.627,21.333,47.36V384    c0,11.733,9.6,21.333,21.333,21.333H96c11.84,0,21.333-9.6,21.333-21.333v-21.333H288V384c0,11.733,9.493,21.333,21.333,21.333    h21.333c11.733,0,21.333-9.6,21.333-21.333v-37.973c13.013-11.733,21.333-28.48,21.333-47.36V85.333    C373.333,10.667,296.96,0,202.667,0z M106.667,320c-17.707,0-32-14.293-32-32s14.293-32,32-32s32,14.293,32,32    S124.373,320,106.667,320z M298.667,320c-17.707,0-32-14.293-32-32s14.293-32,32-32s32,14.293,32,32S316.373,320,298.667,320z     M330.667,192h-256V85.333h256V192z","data-original":"#000000",className:"active-path","data-old_color":"#000000",fill:n})))));case"close":return a.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",height:o,viewBox:"0 0 365.696 365.696",width:r},a.a.createElement("g",null,a.a.createElement("path",{d:"m243.1875 182.859375 113.132812-113.132813c12.5-12.5 12.5-32.765624 0-45.246093l-15.082031-15.082031c-12.503906-12.503907-32.769531-12.503907-45.25 0l-113.128906 113.128906-113.132813-113.152344c-12.5-12.5-32.765624-12.5-45.246093 0l-15.105469 15.082031c-12.5 12.503907-12.5 32.769531 0 45.25l113.152344 113.152344-113.128906 113.128906c-12.503907 12.503907-12.503907 32.769531 0 45.25l15.082031 15.082031c12.5 12.5 32.765625 12.5 45.246093 0l113.132813-113.132812 113.128906 113.132812c12.503907 12.5 32.769531 12.5 45.25 0l15.082031-15.082031c12.5-12.503906 12.5-32.769531 0-45.25zm0 0","data-original":"#000000",class:"active-path","data-old_color":"#000000",fill:n}))," ");case"marker":return a.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",version:"1.1",id:"Layer_1",x:"0px",y:"0px",viewBox:"0 0 512 512",width:r,height:o},a.a.createElement("g",null,a.a.createElement("g",null,a.a.createElement("g",null,a.a.createElement("path",{d:"M256,0C153.755,0,70.573,83.182,70.573,185.426c0,126.888,165.939,313.167,173.004,321.035    c6.636,7.391,18.222,7.378,24.846,0c7.065-7.868,173.004-194.147,173.004-321.035C441.425,83.182,358.244,0,256,0z M256,278.719    c-51.442,0-93.292-41.851-93.292-93.293S204.559,92.134,256,92.134s93.291,41.851,93.291,93.293S307.441,278.719,256,278.719z","data-original":"#000000",class:"active-path","data-old_color":"#000000",fill:n}))))," ");default:return a.a.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",height:o,viewBox:"0 0 365.696 365.696",width:r},a.a.createElement("g",null,a.a.createElement("path",{d:"m243.1875 182.859375 113.132812-113.132813c12.5-12.5 12.5-32.765624 0-45.246093l-15.082031-15.082031c-12.503906-12.503907-32.769531-12.503907-45.25 0l-113.128906 113.128906-113.132813-113.152344c-12.5-12.5-32.765624-12.5-45.246093 0l-15.105469 15.082031c-12.5 12.503907-12.5 32.769531 0 45.25l113.152344 113.152344-113.128906 113.128906c-12.503907 12.503907-12.503907 32.769531 0 45.25l15.082031 15.082031c12.5 12.5 32.765625 12.5 45.246093 0l113.132813-113.132812 113.128906 113.132812c12.503907 12.5 32.769531 12.5 45.25 0l15.082031-15.082031c12.5-12.503906 12.5-32.769531 0-45.25zm0 0","data-original":"#000000",class:"active-path","data-old_color":"#000000",fill:n}))," ")}};x.defaultProps={iconName:"bus",fillColor:"#3F50B5",width:"50px",height:"50px"};var w=x;function y(){var e=Object(g.a)(["\n  height: calc(100% - 50px);\n  overflow: scroll;\n"]);return y=function(){return e},e}function O(){var e=Object(g.a)(["\n  margin: 0px;\n  height: 50px;\n  border-bottom: 1px solid #333;\n  padding-left: 10px;\n  display: flex;\n  flex-direction: row;\n  justify-content: space-between;\n  align-items: center;\n  align-items: center;\n\n  h1 {\n    font-size: 1.5rem;\n    font-weight: bold;\n  }\n\n  button {\n    background: none;\n    border: none;\n  }\n"]);return O=function(){return e},e}function C(){var e=Object(g.a)(["\n  background: white;\n  width: 400px;\n  box-sizing: border-box;\n  height: 80%;\n"]);return C=function(){return e},e}var j=h.a.div(C()),k=h.a.div(O()),_=h.a.div(y()),T=function(e){Object(d.a)(n,e);var t=Object(p.a)(n);function n(){return Object(s.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"render",value:function(){var e=this;return a.a.createElement(j,null,a.a.createElement(k,null,a.a.createElement("h1",null,"Departures"),a.a.createElement("button",{onClick:this.props.onDepartureCancelled},a.a.createElement(w,{iconName:"close",fillColor:"#000",width:"20px"}))),a.a.createElement(_,{style:{height:"100%",overflow:"scroll"}},this.props.departures.map((function(t,n){return a.a.createElement(E,{key:n,onClick:function(){e.props.onDestinationSelected(t.id)}},a.a.createElement("p",null,t.direction),a.a.createElement("p",null,"Departure Time : ",t.best_departure_estimate),a.a.createElement("p",null,"Operator : ",t.operator))}))))}}]),n}(r.Component);function D(){var e=Object(g.a)(["\n  height: calc(100% - 50px);\n  overflow: scroll;\n"]);return D=function(){return e},e}function R(){var e=Object(g.a)(["\n  margin: 0px;\n  height: 50px;\n  border-bottom: 1px solid #333;\n  padding-left: 10px;\n  display: flex;\n  align-items: center;\n\n  h1 {\n    font-size: 1.5rem;\n    font-weight: bold;\n  }\n"]);return R=function(){return e},e}function B(){var e=Object(g.a)(["\n  background: white;\n  width: 400px;\n  box-sizing: border-box;\n  height: 80%;\n"]);return B=function(){return e},e}var N=h.a.div(B()),I=h.a.div(R()),U=h.a.div(D()),P=function(e){Object(d.a)(n,e);var t=Object(p.a)(n);function n(){return Object(s.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"render",value:function(){var e=this;return a.a.createElement(N,null,a.a.createElement(I,null,a.a.createElement("h1",null,"Near By Bus Stops")),a.a.createElement(U,null,this.props.busStops.map((function(t,n){return a.a.createElement(E,{key:n,onClick:function(){return e.props.onStopSelected(t)}},a.a.createElement("p",null,t.label),a.a.createElement("p",null,"Lat : ",t.lat),a.a.createElement("p",null,"Lng : ",t.lng))}))))}}]),n}(r.Component),F=n(53),A=n.n(F);function z(){var e=Object(g.a)(["\n  width: 100%;\n  padding: 10px;\n  box-sizing: border-box;\n  margin-top: 10px;\n  font-size: 1.2rem;\n"]);return z=function(){return e},e}function H(){var e=Object(g.a)(["\n  margin: 0;\n"]);return H=function(){return e},e}function M(){var e=Object(g.a)(["\n  border-bottom: 1px solid #333;\n  padding: 10px;\n  z-index: 10;\n"]);return M=function(){return e},e}function L(){var e=Object(g.a)(["\n  position: absolute;\n  border: 1px solid #000;\n"]);return L=function(){return e},e}function V(){var e=Object(g.a)(["\n  width: 100%;\n  display: flex;\n  flex-direction: row;\n"]);return V=function(){return e},e}function K(){var e=Object(g.a)(["\n  color: #fff;\n  background-color: ",";\n  padding: 10px;\n  height: 20%;\n"]);return K=function(){return e},e}var Y=h.a.div(K(),(function(e){return e.color})),G=h.a.div(V()),J=h.a.div(L()),W=h.a.div(M()),q=h.a.h1(H()),Q=h.a.input(z()),Z=function(e){Object(d.a)(n,e);var t=Object(p.a)(n);function n(){return Object(s.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,[{key:"render",value:function(){var e=this.props,t=e.onInputChange,n=e.handleSelect,r=e.address;return a.a.createElement(Y,{color:S.primaryColor},a.a.createElement(q,null,"Search Starting Point"),a.a.createElement(A.a,{value:r,onChange:t,onSelect:n},(function(e){var t=e.getInputProps,n=e.suggestions,r=e.getSuggestionItemProps,o=e.loading;return a.a.createElement("div",null,a.a.createElement(G,null,a.a.createElement(Q,t({placeholder:"Search Places ...",className:"location-search-input"}))),a.a.createElement(J,{className:"autocomplete-dropdown-container"},o&&a.a.createElement("div",null,"Loading..."),n.map((function(e,t){var n=e.active?"suggestion-item--active":"suggestion-item",o=e.active?{backgroundColor:"#fafafa",color:S.black,cursor:"pointer"}:{backgroundColor:"#ffffff",color:S.black,cursor:"pointer"};return a.a.createElement(W,Object.assign({key:t},r(e,{className:n,style:o})),a.a.createElement("span",null,e.description))}))))})))}}]),n}(r.Component),X="http://transportapi.com/v3/uk";function $(){var e=Object(g.a)(["\n  position: absolute;\n  background: white;\n  width: 400px;\n  height: 100vh;\n  display: flex;\n  flex-direction: column;\n"]);return $=function(){return e},e}var ee={lat:51.5073509,lng:.1123},te=h.a.div($()),ne=function(e){Object(d.a)(n,e);var t=Object(p.a)(n);function n(){var e;return Object(s.a)(this,n),(e=t.call(this)).onDepartureCancelled=function(){e.props.getNearbyBusStops(ee)},e.onDestinationSelected=function(){var t=Object(l.a)(c.a.mark((function t(n){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.props.getDirections({origin:e.props.origin,urlForRoute:n,directionService:e.state.directionService});case 1:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.handleSelect=function(){var t=Object(l.a)(c.a.mark((function t(n){var r,a;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Object(F.geocodeByAddress)(n);case 2:return r=t.sent,t.next=5,Object(F.getLatLng)(r[0]);case 5:a=t.sent,e.setState({address:n},(function(){e.props.getNearbyBusStops(a)}));case 7:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}(),e.onInputChange=function(t){e.setState({address:t})},e.state={directionService:new window.google.maps.DirectionsService,zoom:15,address:""},e}return Object(u.a)(n,[{key:"componentDidMount",value:function(){this.props.getNearbyBusStops(this.props.origin)}},{key:"render",value:function(){var e=this.props,t=e.markers,n=e.getDepartures,r=e.departures,o=e.directions;return console.log("directions",this.props.directions),a.a.createElement("div",{className:"MapsWrapper",style:{margin:0,position:"absolute",top:0}},a.a.createElement(m.GoogleMap,{center:this.props.origin,defaultZoom:16,options:{disableDefaultUI:!0}},o?a.a.createElement(m.DirectionsRenderer,{directions:o}):null,t.map((function(e,t){return a.a.createElement(m.Marker,{title:e.title,onClick:function(){return n(e)},position:e.position,key:t,animation:e.animation})}))),a.a.createElement(te,null,a.a.createElement(Z,{onInputChange:this.onInputChange,handleSelect:this.handleSelect,address:this.state.address}),t.length>0&&0===r.length&&a.a.createElement(P,{busStops:t,onStopSelected:n}),r.length>0&&a.a.createElement(T,{departures:r,onDepartureCancelled:this.onDepartureCancelled,onDestinationSelected:this.onDestinationSelected})))}}]),n}(r.Component),re=Object(f.b)((function(e){return{markers:e.markers,departures:e.departures,directions:e.directions,origin:e.origin}}),(function(e){return{getNearbyBusStops:function(t){return e({type:"FETCH_NEARBY_BUS_STOPS",payload:t})},getDepartures:function(t){return e({type:"FETCH_DEPARTURES",payload:t})},setDepartures:function(t){return e({type:"SET_DEPARTURES",payload:t})},getDirections:function(t){return e({type:"FETCH_DIRECTIONS",payload:t})}}}))(Object(m.withScriptjs)(Object(m.withGoogleMap)(ne))),ae=n(35),oe=n(173),ie={markers:[],departures:[],directions:[],origin:{lat:51.5073509,lng:.1123}},ce=n(22),le=n(75),se=n.n(le),ue=(n(399),c.a.mark(fe)),pe=c.a.mark(he),de=c.a.mark(be),ge=c.a.mark(ve);function me(e){return se.a.get("".concat(X,"/places.json?type=bus_stop&lat=").concat(e.lat,"&lon=").concat(e.lng,"&app_key=c96bd60a6078bb1f13227063d1529bed&app_id=0fade918"))}function fe(e){var t,n,r,a,o,i;return c.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:return c.prev=0,c.next=3,Object(ce.a)(me,e.payload);case 3:if(200!==(t=c.sent).status){c.next=11;break}for(n=[],r=t.data.member,a=0;a<r.length;a++)o={lat:r[a].latitude,lng:r[a].longitude},i=new google.maps.Marker({position:o,title:r[a].name,label:r[a].name,data:r[a].atcocode,selected:!1,lat:r[a].latitude,lng:r[a].longitude,animation:2,icon:"../images/bus.png"}),n.push(i);return console.log("Saga successs"),c.next=11,Object(ce.b)({type:"FETCH_NEARBY_BUS_STOPS_SUCCESS",payload:{markers:n,origin:e.payload}});case 11:c.next=18;break;case 13:return c.prev=13,c.t0=c.catch(0),console.log("Saga fail"),c.next=18,Object(ce.b)({type:"FETCH_NEARBY_BUS_STOPS_FAIL"});case 18:case"end":return c.stop()}}),ue,null,[[0,13]])}function he(e){var t,n,r;return c.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:return t=e.payload,a.prev=1,a.next=4,se.a.get("".concat(X,"/bus/stop/").concat(t.data,"/live.json?app_key=c96bd60a6078bb1f13227063d1529bed&app_id=0fade918&limit=20&nextbuses=no&group=no"));case 4:if(200!==(n=a.sent).status){a.next=9;break}return r=n.data.departures.all,a.next=9,Object(ce.b)({type:"FETCH_DEPARTURES_SUCCESS",payload:{departures:r,markers:[t],origin:{lat:t.lat,lng:t.lng}}});case 9:a.next=15;break;case 11:return a.prev=11,a.t0=a.catch(1),a.next=15,Object(ce.b)({type:"FETCH_DEPARTURES_FAIL"});case 15:case"end":return a.stop()}}),pe,null,[[1,11]])}function be(e){var t,n,r,a,o,i,l,s,u;return c.a.wrap((function(c){for(;;)switch(c.prev=c.next){case 0:return t=e.payload,n=t.directionService,r=t.origin,a=t.urlForRoute,c.prev=1,c.next=4,se.a.get(a);case 4:if(200!==(o=c.sent).status){c.next=14;break}return i=o.data.stops,l=i[i.length-1],s={lat:l.latitude,lng:l.longitude},c.next=11,new Promise((function(e){n.route({origin:r,destination:s,travelMode:google.maps.TravelMode.TRANSIT,transitOptions:{modes:[google.maps.TransitMode.BUS],routingPreference:google.maps.TransitRoutePreference.LESS_WALKING}},(function(t,n){n===google.maps.DirectionsStatus.OK?e(t):e([])}))}));case 11:return u=c.sent,c.next=14,Object(ce.b)({type:"FETCH_DIRECTIONS_SUCCESS",payload:u});case 14:c.next=19;break;case 16:c.prev=16,c.t0=c.catch(1),console.log(c.t0);case 19:case"end":return c.stop()}}),de,null,[[1,16]])}function ve(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Object(ce.c)("FETCH_NEARBY_BUS_STOPS",fe);case 2:return e.next=4,Object(ce.c)("FETCH_DEPARTURES",he);case 4:return e.next=6,Object(ce.c)("FETCH_DIRECTIONS",be);case 6:case"end":return e.stop()}}),ge)}var Ee=ve,Se=Object(oe.a)(),xe=Object(ae.d)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ie,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"FETCH_NEARBY_BUS_STOPS_SUCCESS":var n=t.payload,r=n.origin,a=n.markers;return Object.assign({},e,{markers:a,departures:[],directions:null,origin:r});case"FETCH_DEPARTURES_SUCCESS":var o=t.payload.departures;return Object.assign({},e,{departures:o,markers:t.payload.markers,origin:t.payload.origin});case"SET_DEPARTURES":return Object.assign({},e,{departures:[]});case"FETCH_DIRECTIONS_SUCCESS":return Object.assign({},e,{directions:t.payload});default:return e}}),Object(ae.a)(Se));Se.run(Ee);var we=xe,ye=document.getElementById("root"),Oe="https://maps.googleapis.com/maps/api/js?v=3.exp&key=AIzaSyCK8olcHBnrwuIihenuSqP5wNQdmKuJ7VI&libraries=places&region=UK",Ce=r.createElement("div",null),je=r.createElement("div",{style:{height:"100vh"}}),ke=r.createElement("div",{style:{height:"100vh"}});ye&&o.render(r.createElement(f.a,{store:we},r.createElement("div",{style:{height:"100vh"}},r.createElement(re,{loadingElement:Ce,containerElement:je,googleMapURL:Oe,mapElement:ke}))),ye)}},[[175,1,2]]]);
//# sourceMappingURL=main.a476a7eb.chunk.js.map